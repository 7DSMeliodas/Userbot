from pyrobot import BOT
from pyrogram import Filters, Message
from time import sleep
import text_to_image
import os

#Encode
@BOT.on_message(Filters.command("txt", "."))
def tti(bot: BOT, message: Message):
    #text = text_to_image.encode(text, "image.png")
    if not len(message.command) > 1:
        message.edit("I need text...")
        sleep(2)
        message.delete()
        return
    text = " ".join(message.command[1:])
    send = text_to_image.encode(text, "image.png")
    message.delete()
    BOT.send_document(
        chat_id=message.chat.id,
        document='image.png')
    os.remove('image.png')

#Decode
@BOT.on_message(Filters.regex('^decode$') & Filters.photo | Filters.document)
def itt(bot: BOT, message: Message):
    if message == message.photo:
        BOT.download_media(
            message=message.photo,
            file_name='image.png')
    elif message == message.document:
        BOT.download_media(
            message=message.document,
            file_name='image.png')
    decoded = text_to_image.decode("image.png")
    message.delete()
    BOT.send_message(message.chat.id, "**Dein entschl√ºsseltes Bild hat den Inhalt:**\n\n" + decoded)
    #os.remove('image.png')
